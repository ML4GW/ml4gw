<!DOCTYPE html>
<html class="writer-html5" lang="python" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ml4gw.transforms.whitening &mdash; ml4gw  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d048f138"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ml4gw.types" href="ml4gw.types.html" />
    <link rel="prev" title="ml4gw.transforms.waveforms" href="ml4gw.transforms.waveforms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ml4gw
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Example Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ml4gw_tutorial.html">Tutorial on the basics of <code class="docutils literal notranslate"><span class="pre">ml4gw</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ml4gw_lfi_tutorial.html">Tutorial on distribution approximation and posterior estimation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="ml4gw.html">ml4gw</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ml4gw.augmentations.html">ml4gw.augmentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.constants.html">ml4gw.constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.dataloading.html">ml4gw.dataloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.distributions.html">ml4gw.distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.gw.html">ml4gw.gw</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.nn.html">ml4gw.nn</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.spectral.html">ml4gw.spectral</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ml4gw.transforms.html">ml4gw.transforms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.decimator.html">ml4gw.transforms.decimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.iirfilter.html">ml4gw.transforms.iirfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.pearson.html">ml4gw.transforms.pearson</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.qtransform.html">ml4gw.transforms.qtransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.scaler.html">ml4gw.transforms.scaler</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.snr_rescaler.html">ml4gw.transforms.snr_rescaler</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.spectral.html">ml4gw.transforms.spectral</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.spectrogram.html">ml4gw.transforms.spectrogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.spline_interpolation.html">ml4gw.transforms.spline_interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.transform.html">ml4gw.transforms.transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="ml4gw.transforms.waveforms.html">ml4gw.transforms.waveforms</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ml4gw.transforms.whitening</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ml4gw.transforms.whitening.FixedWhiten"><code class="docutils literal notranslate"><span class="pre">FixedWhiten</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ml4gw.transforms.whitening.Whiten"><code class="docutils literal notranslate"><span class="pre">Whiten</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.types.html">ml4gw.types</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml4gw.waveforms.html">ml4gw.waveforms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ml4gw.utils.html">ml4gw.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ml4gw</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="ml4gw.html">ml4gw</a></li>
          <li class="breadcrumb-item"><a href="ml4gw.transforms.html">ml4gw.transforms</a></li>
      <li class="breadcrumb-item active">ml4gw.transforms.whitening</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/ml4gw.transforms.whitening.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ml4gw.transforms.whitening">
<span id="ml4gw-transforms-whitening"></span><h1>ml4gw.transforms.whitening<a class="headerlink" href="#module-ml4gw.transforms.whitening" title="Link to this heading"></a></h1>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ml4gw.transforms.whitening.FixedWhiten" title="ml4gw.transforms.whitening.FixedWhiten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedWhiten</span></code></a>(num_channels, kernel_length, ...)</p></td>
<td><p>Transform that whitens timeseries by a fixed power spectral density that's determined by calling the <code class="docutils literal notranslate"><span class="pre">.fit</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ml4gw.transforms.whitening.Whiten" title="ml4gw.transforms.whitening.Whiten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Whiten</span></code></a>(fduration, sample_rate[, highpass, ...])</p></td>
<td><p>Normalize the frequency content of timeseries data by a provided power spectral density, such that if the timeseries are sampled from the same distribution as the PSD the normalized power will be approximately unity across all frequency bins.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="ml4gw.transforms.whitening.FixedWhiten">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ml4gw.transforms.whitening.</span></span><span class="sig-name descname"><span class="pre">FixedWhiten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ml4gw.transforms.whitening.FixedWhiten" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ml4gw.transforms.transform.html#ml4gw.transforms.transform.FittableSpectralTransform" title="ml4gw.transforms.transform.FittableSpectralTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">FittableSpectralTransform</span></code></a></p>
<p>Transform that whitens timeseries by a fixed
power spectral density that's determined by
calling the <code class="docutils literal notranslate"><span class="pre">.fit</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_channels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) -- Number of channels to whiten</p></li>
<li><p><strong>kernel_length</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) -- Expected length of tensors to whiten
in seconds. Determines the number of
frequency bins in the fit PSD.</p></li>
<li><p><strong>sample_rate</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) -- Rate at which timeseries will be sampled, in Hz</p></li>
<li><p><strong>crop</strong> -- Datatype with which background PSD will be stored</p></li>
<li><p><strong>dtype</strong> (<em>dtype</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ml4gw.transforms.whitening.FixedWhiten.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fduration</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">background</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fftlength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ml4gw.transforms.whitening.FixedWhiten.fit" title="Link to this definition"></a></dt>
<dd><p>Compute the PSD of channel-wise background to
use to whiten timeseries at call time. PSDs will
be resampled to have
<code class="docutils literal notranslate"><span class="pre">self.kernel_length</span> <span class="pre">*</span> <span class="pre">self.sample_rate</span> <span class="pre">//</span> <span class="pre">2</span> <span class="pre">+</span> <span class="pre">1</span></code>
frequency bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fduration</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) -- Desired length of the impulse response
of the whitening filter, in seconds.
Fit PSDs will have their spectrum truncated
to approximate this response time.
A longer <code class="docutils literal notranslate"><span class="pre">fduration</span></code> will be able to
handle narrower spikes in frequency, but
at the expense of longer filter settle-in
time. As such <code class="docutils literal notranslate"><span class="pre">fduration</span> <span class="pre">/</span> <span class="pre">2</span></code> seconds of data
will be removed from each edge of whitened
timeseries.</p></li>
<li><p><strong>*background</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'time']</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'frequency']</span></code></span>) -- 1D arrays capturing the signal to be used to
whiten each channel at call time. If <code class="docutils literal notranslate"><span class="pre">fftlength</span></code>
is left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will be assumed that these
already represent frequency-domain data that will
be possibly resampled and truncated to whiten
timeseries at call time. Otherwise, it will be
assumed that these represent time-domain data that
will be converted to the frequency domain via
Welch's method using the specified <code class="docutils literal notranslate"><span class="pre">fftlength</span></code>
and <code class="docutils literal notranslate"><span class="pre">overlap</span></code>, with a Hann window used to window
the FFT frames by default. Should have the same
number of args as <code class="docutils literal notranslate"><span class="pre">self.num_channels</span></code>.</p></li>
<li><p><strong>fftlength</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) -- Length of frames used to convert time-domain
data to the frequency-domain via Welch's method.
If left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will be assumed that the
background arrays passed already represent frequency-
domain data and don't require any conversion.</p></li>
<li><p><strong>highpass</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) -- Cutoff frequency, in Hz, used for highpass filtering
with the fit whitening filter. This is achieved by
setting the frequency response of the fit PSDs
in the frequency bins below this value to 0.
If left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, the fit filter won't have any
highpass filtering properties.</p></li>
<li><p><strong>lowpass</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) -- Cutoff frequency, in Hz, used for lowpass filtering
with the fit whitening filter. This is achieved by
setting the frequency response of the fit PSDs
in the frequency bins above this value to 0.
If left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, the fit filter won't have any
lowpass filtering properties.</p></li>
<li><p><strong>overlap</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) -- Overlap between FFT frames used to convert
time-domain data to the frequency domain via
Welch's method. If <code class="docutils literal notranslate"><span class="pre">fftlength</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, this
is ignored. Otherwise, if left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will
be set to half of <code class="docutils literal notranslate"><span class="pre">fftlength</span></code> by default.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ml4gw.transforms.whitening.FixedWhiten.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ml4gw.transforms.whitening.FixedWhiten.forward" title="Link to this definition"></a></dt>
<dd><p>Whiten the input timeseries tensor using the
PSD fit by the <code class="docutils literal notranslate"><span class="pre">.fit</span></code> method, which must be
called <strong>before</strong> the first call to <code class="docutils literal notranslate"><span class="pre">.forward</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'batch</span> <span class="pre">channel</span> <span class="pre">time']</span></code></span>) -- Batch of multichannel timeseries to whiten.
Should have the shape <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">C,</span> <span class="pre">N)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch size, <code class="docutils literal notranslate"><span class="pre">C</span></code> is the number of
channels, and <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of seconds
in the timeseries times <code class="docutils literal notranslate"><span class="pre">self.sample_rate</span></code>.</p></li>
<li><p><strong>crop</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- If <code class="docutils literal notranslate"><span class="pre">True</span></code>, crop <code class="docutils literal notranslate"><span class="pre">fduration</span> <span class="pre">/</span> <span class="pre">2</span></code> seconds of data
from both sides of the time dimension to remove the
corruption from the filter. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, return the
full timeseries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'batch</span> <span class="pre">channel</span> <span class="pre">time']</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ml4gw.transforms.whitening.Whiten">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ml4gw.transforms.whitening.</span></span><span class="sig-name descname"><span class="pre">Whiten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fduration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ml4gw.transforms.whitening.Whiten" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Normalize the frequency content of timeseries
data by a provided power spectral density, such
that if the timeseries are sampled from the same
distribution as the PSD the normalized power will
be approximately unity across all frequency bins.
The whitened timeseries will then also have
0 mean and unit variance.</p>
<p>In order to avoid edge effects due to filter settle-in,
the provided PSDs will have their spectrum truncated
such that their impulse response time in the time
domain is <code class="docutils literal notranslate"><span class="pre">fduration</span></code> seconds, and <code class="docutils literal notranslate"><span class="pre">fduration</span> <span class="pre">/</span> <span class="pre">2</span></code>
seconds worth of data will be removed from each
edge of the whitened timeseries.</p>
<p>For more information, see the documentation for
<a class="reference internal" href="ml4gw.spectral.html#ml4gw.spectral.whiten" title="ml4gw.spectral.whiten"><code class="xref py py-meth docutils literal notranslate"><span class="pre">whiten()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fduration</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) -- The length of the whitening filter's impulse
response, in seconds. <code class="docutils literal notranslate"><span class="pre">fduration</span> <span class="pre">/</span> <span class="pre">2</span></code> seconds
worth of data will be cropped from the edges
of the whitened timeseries.</p></li>
<li><p><strong>sample_rate</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) -- Rate at which timeseries data passed at call
time is expected to be sampled</p></li>
<li><p><strong>highpass</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) -- Cutoff frequency to apply highpass filtering
during whitening. If left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, no highpass
filtering will be performed.</p></li>
<li><p><strong>lowpass</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) -- Cutoff frequency to apply lowpass filtering
during whitening. If left as <code class="docutils literal notranslate"><span class="pre">None</span></code>, no lowpass
filtering will be performed.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ml4gw.transforms.whitening.Whiten.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ml4gw.transforms.whitening.Whiten.forward" title="Link to this definition"></a></dt>
<dd><p>Whiten a batch of multichannel timeseries by a
background power spectral density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'batch</span> <span class="pre">channel</span> <span class="pre">time']</span></code></span>) -- Batch of multichannel timeseries to whiten.
Should have the shape <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">C,</span> <span class="pre">N)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">B</span></code> is the batch size, <code class="docutils literal notranslate"><span class="pre">C</span></code> is the number of
channels, and <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of seconds
in the timeseries times <code class="docutils literal notranslate"><span class="pre">self.sample_rate</span></code>.</p></li>
<li><p><strong>psd</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'frequency']</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'channel</span> <span class="pre">frequency']</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'batch</span> <span class="pre">channel</span> <span class="pre">frequency']</span></code></span>) -- Power spectral density used to whiten the
provided timeseries. Can be either 1D, 2D,
or 3D, with the last dimension representing
power at each frequency value. All other
dimensions must match their corresponding
value in <code class="docutils literal notranslate"><span class="pre">X</span></code>, starting from the right.
(e.g. if <code class="docutils literal notranslate"><span class="pre">psd.ndim</span> <span class="pre">==</span> <span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">psd.size(1)</span></code> should
be equal to <code class="docutils literal notranslate"><span class="pre">X.size(1)</span></code>. If <code class="docutils literal notranslate"><span class="pre">psd.ndim</span> <span class="pre">==</span> <span class="pre">3</span></code>,
<code class="docutils literal notranslate"><span class="pre">psd.size(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">psd.size(0)</span></code> should be equal
to <code class="docutils literal notranslate"><span class="pre">X.size(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">X.size(0)</span></code>, respectively.)
For more information about what these different
shapes for <code class="docutils literal notranslate"><span class="pre">psd</span></code> represent, consult the documentation
for <a class="reference internal" href="ml4gw.spectral.html#ml4gw.spectral.whiten" title="ml4gw.spectral.whiten"><code class="xref py py-meth docutils literal notranslate"><span class="pre">whiten()</span></code></a>.</p></li>
<li><p><strong>crop</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) -- If <code class="docutils literal notranslate"><span class="pre">True</span></code>, crop <code class="docutils literal notranslate"><span class="pre">fduration</span> <span class="pre">/</span> <span class="pre">2</span></code> seconds of data
from both sides of the time dimension to remove the
corruption from the filter. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, return the
full timeseries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Tensor,</span> <span class="pre">'batch</span> <span class="pre">channel</span> <span class="pre">time']</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Whitened timeseries, with <code class="docutils literal notranslate"><span class="pre">fduration</span> <span class="pre">*</span> <span class="pre">sample_rate</span> <span class="pre">/</span> <span class="pre">2</span></code></dt><dd><p>samples cropped from each edge. Output shape will then
be <code class="docutils literal notranslate"><span class="pre">(B,</span> <span class="pre">C,</span> <span class="pre">N</span> <span class="pre">-</span> <span class="pre">fduration</span> <span class="pre">*</span> <span class="pre">sample_rate)</span></code>.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ml4gw.transforms.waveforms.html" class="btn btn-neutral float-left" title="ml4gw.transforms.waveforms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ml4gw.types.html" class="btn btn-neutral float-right" title="ml4gw.types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Ethan Marx &lt;emarx@mit.edu&gt;, Will Benoit &lt;benoi090@umn.edu&gt;, Deep Chatterjee &lt;deep1018@mit.edu&gt;.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>